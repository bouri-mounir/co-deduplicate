boolean hadTransDuplicate=false;
for (int i=0;i<ctx._source.duplicate.length;i++) {
    if (ctx._source.duplicate[i].rules.length==0) {
         hadTransDuplicate = true
    }
}
ctx._source.hadTransDuplicate = hadTransDuplicate
